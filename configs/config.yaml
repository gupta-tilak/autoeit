audio:
  sample_rate: 16000
  channels: 1
  max_duration_sec: 30
  silence_thresh_db: -40
  min_silence_ms: 300
  min_utterance_sec: 0.5

model:
  base_model: "openai/whisper-large-v3"
  language: "es"
  task: "transcribe"
  use_lora: true
  lora_r: 16
  lora_alpha: 32
  lora_dropout: 0.05
  target_modules: ["q_proj", "v_proj", "k_proj", "out_proj", "fc1", "fc2"]

training:
  batch_size: 8
  gradient_accumulation: 4
  learning_rate: 1.0e-5
  warmup_steps: 300
  max_steps: 3000
  fp16: true
  eval_steps: 300
  save_steps: 300

paths:
  manifest: "manifest.csv"
  data_root: "."
  processed_data: "data/processed"
  transcripts: "data/transcripts"
  output_dir: "models/checkpoints"
  results_dir: "results"

datasets:
  Nebrija-INMIGRA:
    l1_map: "from l1_group column directly"
    speaker_id: "media_stem"
    denoise_strength: 0.80
    snr_threshold: 5.0
  Nebrija-WOCAE:
    l1_map:
      "2018": "Chinese"
      "2019": "Chinese"
      "Chinese": "Chinese"
    speaker_id: "media_stem"
    denoise_strength: 0.75
    snr_threshold: 4.0
  SPLLOC1:
    l1_map: "all English"
    speaker_id: "media_stem + role_code"
    denoise_strength: 0.70
    snr_threshold: 5.0

splits:
  train_fraction: 0.70
  dev_fraction: 0.15
  test_fraction: 0.15
  random_seed: 42

augmentation:
  seed: 42
  target_dbfs: -20.0

  datasets:
    Nebrija-INMIGRA:
      multiplier: 4
      min_l1_pct: 0.05          # each L1 must be â‰¥5% of INMIGRA total
      low_resource_multiplier: 6 # L1 groups with < 3 original sessions
      strategies:
        - tag: sp090_wn15
          speed_factor: 0.90
          noise_type: white
          noise_snr_db: 15
        - tag: sp110_pn18
          speed_factor: 1.10
          noise_type: pink
          noise_snr_db: 18
        - tag: sp095_revsm
          speed_factor: 0.95
          reverb: small

    Nebrija-WOCAE:
      multiplier: 4
      strategies:
        - tag: sp085_wn12
          speed_factor: 0.85
          noise_type: white
          noise_snr_db: 12
        - tag: sp115_ps1_pn16
          speed_factor: 1.15
          pitch_steps: 1
          noise_type: pink
          noise_snr_db: 16
        - tag: sp105_revmd
          speed_factor: 1.05
          reverb: medium

    SPLLOC1:
      multiplier: 2
      strategies:
        - tag: sp092_vj
          speed_factor: 0.92
          volume_jitter: true
